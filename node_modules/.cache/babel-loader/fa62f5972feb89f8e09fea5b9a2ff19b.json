{"remainingRequest":"/Users/eduardo/Documents/sala-cine-vue/node_modules/babel-loader/lib/index.js!/Users/eduardo/Documents/sala-cine-vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/eduardo/Documents/sala-cine-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/eduardo/Documents/sala-cine-vue/src/components/Sala.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/eduardo/Documents/sala-cine-vue/src/components/Sala.vue","mtime":1558830227849},{"path":"/Users/eduardo/Documents/sala-cine-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/eduardo/Documents/sala-cine-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/eduardo/Documents/sala-cine-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/eduardo/Documents/sala-cine-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport firebase from 'firebase';\nvar path = 'salas';\nvar pathId = '1';\nexport default {\n  created: function created() {\n    this.actualizarElementos();\n    /*\n    this.id = firebase.database().ref('/users').push().key\n     firebase.database()\n    .ref(path)\n    .child(pathId)\n    .on('value', snapshot => this.cargarElementos(snapshot.val()) )\n    */\n  },\n  data: function data() {\n    return {\n      id: '',\n      contador: 0,\n      asientos: [{\n        id: 'A1',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A2',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A3',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A4',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A5',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A6',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A7',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A8',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A9',\n        disponible: true,\n        purchased: false\n      }, {\n        id: 'A10',\n        disponible: true,\n        purchased: false\n      }]\n    };\n  },\n  methods: {\n    seleccionarAsiento: function seleccionarAsiento(event) {\n      var asiento = this.asientos.find(function (a) {\n        return a.id == event.target.id;\n      });\n\n      if (asiento.adquirido || asiento.user_id != null && asiento.user_id != this.id) {\n        this.$notify({\n          group: 'foo',\n          type: 'error',\n          title: 'Error',\n          text: 'No es posible seleccionar el asiento ' + asiento.id\n        });\n        return;\n      }\n\n      asiento.disponible = !asiento.disponible;\n      asiento.user_id = this.id;\n      this.actualizarElementos();\n      this.contador = this.asientosSeleccionados().length;\n    },\n    actualizarElementos: function actualizarElementos() {\n      firebase.database().ref(path).child(pathId).set(this.asientos);\n    },\n    validarRespuesta: function validarRespuesta(error, committed, snapshot) {\n      if (error) {\n        this.$notify({\n          group: 'foo',\n          type: 'error',\n          title: 'Error',\n          text: 'No es posible completar la operaci√≥n'\n        });\n      }\n\n      if (committed) {\n        this.$notify({\n          group: 'foo',\n          type: 'success',\n          title: 'Exito',\n          text: 'Asientos adquiridos exitosamente'\n        });\n      }\n\n      console.log(snapshot.val());\n    },\n    cargarElementos: function cargarElementos(data) {\n      this.asientos = data;\n    },\n    guardar: function guardar() {\n      var _this = this;\n\n      firebase.database().ref(path).child(pathId).transaction(function (valoresDB) {\n        return _this.validarCompra(valoresDB);\n      }, function (error, committed, snapshot) {\n        return _this.validarRespuesta(error, committed, snapshot);\n      });\n      this.contador = 0;\n    },\n    validarCompra: function validarCompra(valoresDB) {\n      this.asientosSeleccionados().forEach(function (asiento) {\n        if (valoresDB.find(function (a) {\n          return a.id == asiento.id;\n        }).adquirido) {\n          return;\n        }\n\n        asiento.adquirido = true;\n      });\n      return this.asientos;\n    },\n    cancelar: function cancelar() {\n      this.asientosSeleccionados().forEach(function (asiento) {\n        asiento.user_id = null;\n        asiento.disponible = true;\n      });\n      this.actualizarElementos();\n      this.contador = 0;\n    },\n    validarAsientos: function validarAsientos() {\n      this.asientosSeleccionados().forEach(function (asiento) {\n        asiento.adquirido = true;\n      });\n    },\n    asientoDiponible: function asientoDiponible(asiento) {\n      return !asiento.adquirido && (asiento.user_id == null || asiento.user_id == this.id);\n    },\n    asientosSeleccionados: function asientosSeleccionados() {\n      return this.asientos.filter(function (a) {\n        return !a.disponible && !a.adquirido;\n      });\n    },\n    liberar: function liberar() {\n      this.asientos.forEach(function (asiento) {\n        asiento.adquirido = false;\n        asiento.disponible = true;\n        asiento.user_id = null;\n      });\n      this.actualizarElementos();\n      this.contador = 0;\n    }\n  }\n};",{"version":3,"sources":["Sala.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"html\">\n  <div class=\"container\">\n\n    <div class=\"pantalla\">\n      <p class=\"font-weight-bold\" style=\"color:white; font-size:18px;\">Pantalla</p>\n    </div>\n\n    <div class=\"asientos\">\n      <div class=\"row\">\n        <div class=\"col asiento\"\n          v-for=\"asiento in asientos\"\n          v-text=\"asiento.id\"\n          v-bind:id=\"asiento.id\"\n          v-bind:class=\"{disponible: asiento.disponible, ocupado: !asiento.disponible, pointer: asientoDiponible(asiento)}\"\n          @click=\"seleccionarAsiento\"\n          >\n        </div>\n      </div>\n    </div>\n\n    <div class=\"botones\">\n      <b-button :disabled=\"contador == 0\" variant=\"success\" @click=\"guardar\">Guardar</b-button>\n      <b-button style=\"margin-left:10px;\" :disabled=\"contador == 0\" variant=\"danger\" @click=\"cancelar\">Cancelar</b-button>\n      <b-button style=\"margin-left:10px;\" @click=\"liberar\">Liberar</b-button>\n    </div>\n\n    <div style=\"margin-top:20px;\">\n      <strong>Asientos seleccionados {{ contador }}</strong>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport firebase from 'firebase'\n\nconst path = 'salas'\nconst pathId = '1'\n\nexport default {\n  created(){\n    this.actualizarElementos()\n    /*\n    this.id = firebase.database().ref('/users').push().key\n\n    firebase.database()\n    .ref(path)\n    .child(pathId)\n    .on('value', snapshot => this.cargarElementos(snapshot.val()) )\n    */\n  },\n\n  data(){\n    return {\n      id: '',\n      contador: 0,\n      asientos: [\n        {id: 'A1', disponible: true, purchased: false}, {id: 'A2', disponible: true, purchased: false}, {id: 'A3', disponible: true, purchased: false}, {id: 'A4', disponible: true, purchased: false}, {id: 'A5', disponible: true, purchased: false},\n        {id: 'A6', disponible: true, purchased: false}, {id: 'A7', disponible: true, purchased: false}, {id: 'A8', disponible: true, purchased: false}, {id: 'A9', disponible: true, purchased: false}, {id: 'A10', disponible: true, purchased: false},\n      ]\n    }\n  },\n\n  methods: {\n    seleccionarAsiento: function(event){\n      let asiento = this.asientos.find(a => a.id == event.target.id)\n      if(asiento.adquirido || (asiento.user_id != null && asiento.user_id != this.id) ){\n\n        this.$notify({\n          group:'foo', type:'error', title:'Error', text:'No es posible seleccionar el asiento ' + asiento.id\n        })\n\n        return\n      }\n\n      asiento.disponible = !asiento.disponible\n      asiento.user_id = this.id\n      this.actualizarElementos()\n\n      this.contador = this.asientosSeleccionados().length\n    },\n\n    actualizarElementos: function(){\n      firebase.database()\n      .ref(path)\n      .child(pathId)\n      .set(this.asientos)\n    },\n\n    validarRespuesta: function(error, committed, snapshot){\n      if(error){\n        this.$notify({\n          group:'foo', type:'error', title:'Error', text:'No es posible completar la operaci√≥n'\n        })\n      }\n\n      if(committed){\n        this.$notify({\n          group:'foo', type:'success', title:'Exito', text:'Asientos adquiridos exitosamente'\n        })\n      }\n\n      console.log(snapshot.val())\n    },\n\n    cargarElementos: function(data){\n      this.asientos = data\n    },\n\n    guardar: function(){\n      firebase.database()\n      .ref(path)\n      .child(pathId)\n      .transaction(\n        valoresDB => this.validarCompra(valoresDB),\n        (error, committed, snapshot) => this.validarRespuesta(error, committed, snapshot)\n      )\n      this.contador = 0\n\n    },\n\n    validarCompra: function(valoresDB){\n      this.asientosSeleccionados().forEach(function(asiento){\n\n        if(valoresDB.find(a => a.id == asiento.id).adquirido){\n          return\n        }\n        asiento.adquirido = true\n      })\n\n      return this.asientos\n    },\n\n    cancelar: function(){\n      this.asientosSeleccionados().forEach(function(asiento){\n        asiento.user_id = null\n        asiento.disponible = true\n      })\n\n      this.actualizarElementos()\n      this.contador = 0\n    },\n\n    validarAsientos: function(){\n      this.asientosSeleccionados().forEach(function(asiento){\n        asiento.adquirido = true\n      })\n    },\n\n    asientoDiponible: function(asiento){\n      return !asiento.adquirido && (asiento.user_id == null || asiento.user_id == this.id)\n    },\n\n    asientosSeleccionados: function(){\n      return this.asientos.filter(a => !a.disponible && !a.adquirido)\n    },\n\n    liberar: function(){\n      this.asientos.forEach(function(asiento){\n        asiento.adquirido = false\n        asiento.disponible = true\n        asiento.user_id = null\n      })\n      this.actualizarElementos()\n      this.contador = 0\n    }\n  }\n}\n</script>\n\n<style lang=\"css\" scoped>\n  .pantalla{\n    background-color: #2b6282;\n  }\n\n  .asientos{\n    margin-top: 60px;\n  }\n\n  .asiento{\n    color:white;\n    margin:3px;\n    font-weight:bold;\n  }\n\n  .pointer{\n    cursor: pointer;\n  }\n\n  .disponible{\n    background-color: #2d4d86;\n  }\n\n  .ocupado{\n    background-color: #73264f;\n  }\n\n  .botones{\n    margin-top:60px;\n  }\n</style>\n"],"sourceRoot":"src/components"}]}